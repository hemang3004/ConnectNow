(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[293],{9884:function(e,t,n){"use strict";var r,i=n(4799),s=n(5515),a=(n(2791),n(1024)),o=n(184);t.Z=function(e){var t=e.user1,n=e.handleFunction,c=e.admin,l=(0,a.g)().user;return r=l._id===c._id,(0,o.jsx)("div",{children:r?(0,o.jsxs)(s.C,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:n,children:[t.name,c._id===t._id&&(0,o.jsx)("span",{children:" (Admin)"}),c._id===l._id&&(0,o.jsx)(i.T,{pl:1})]}):(0,o.jsxs)(s.C,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",children:[t.name,c._id===t._id&&(0,o.jsx)("span",{children:" (Admin)"}),c._id===l._id&&(0,o.jsx)(i.T,{pl:1})]})})}},7573:function(e,t,n){"use strict";var r=n(7732),i=n(4087),s=n(9229),a=(n(2791),n(184));t.Z=function(e){var t=e.user,n=e.handleFunction;return(0,a.jsxs)(i.xu,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#2b6cb0",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[(0,a.jsx)(r.q,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),(0,a.jsxs)(i.xu,{children:[(0,a.jsx)(s.x,{children:t.name}),(0,a.jsxs)(s.x,{fontSize:"xs",children:[(0,a.jsx)("b",{children:"Email : "}),t.email]})]})]})}},8048:function(e,t,n){"use strict";var r=n(840),i=n(8348),s=n(7885),a=n(1820),o=n(3380),c=n(2449),l=n(7693),u=n(1461),d=n(7521),p=n(8082),f=n(7732),x=n(9229),h=n(4653),m=n(4224),g=(n(2791),n(184));t.Z=function(e){var t=e.user,n=e.children,k=(0,i.q)(),v=k.isOpen,y=k.onOpen,j=k.onClose;return(0,g.jsxs)(g.Fragment,{children:[n?(0,g.jsx)("span",{onClick:y,children:n}):(0,g.jsx)(s.h,{display:{base:"flex"},icon:(0,g.jsx)(r.s,{}),onClick:y}),(0,g.jsxs)(a.u_,{size:"lg",onClose:j,isOpen:v,isCentered:!0,children:[(0,g.jsx)(o.Z,{}),(0,g.jsxs)(c.h,{h:"410px",children:[(0,g.jsx)(l.x,{fontSize:"40px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:t.name}),(0,g.jsx)(u.o,{}),(0,g.jsxs)(d.f,{display:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[t.pic?(0,g.jsx)(p.E,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}):(0,g.jsx)(f.q,{size:"2xl",cursor:"pointer",name:t.name}),(0,g.jsxs)(x.x,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",children:["Email: ",t.email]})]}),(0,g.jsx)(h.m,{children:(0,g.jsx)(m.z,{colorScheme:"blue",mr:3,onClick:j,children:"Close"})})]})]})]})}},4561:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ie}});var r,i=n(9439),s=n(4087),a=n(2791),o=(n(5089),n(3433)),c=n(4165),l=n(5861),u=n(2055),d=n(2701),p=n(7886),f=n(9229),x=n(2893),h=n(5232),m=n(8348),g=n(1295),k=n(7885),v=n(3544),y=n(3380),j=n(7693),b=n(7521),_=n(4653),Z=n(4224),C=n(3204),w=n(1622),S=n(3263),E=n(8048),z=n(7732),F=n(7377),A=n(8385),D=n(9704),O=n.n(D),I=n(7281),M=n(1024),U=n(3528),L=n.n(U),N=n(184),R={pdf:"https://cdn4.iconfinder.com/data/icons/logos-and-brands/512/27_Pdf_File_Type_Adobe_logo_logos-512.png",png:"http://res.cloudinary.com/dm37epkmg/image/upload/v1682328226/fbrtebnvqsbdiwlkdccj.png"},B=function(e){var t,n=e.messages,r=(0,M.g)(),i=r.user,s=r.selectedChat,a=function(e){if(null===e){var t,n=new Date(function(){var e=new Date;return e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+" "+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds()}()),r=-L().tz(n,i.timeZone).utcOffset();return n.setMinutes(n.getMinutes()-r),t=("0"+n.getDate()).slice(-2)+"/"+("0"+(n.getMonth()+1)).slice(-2)+"/"+n.getFullYear(),console.log(t),t}var s=new Date(e),a=new Date,o=-L().tz(a,i.timeZone).utcOffset();return s.setMinutes(s.getMinutes()-o),("0"+s.getDate()).slice(-2)+"/"+("0"+(s.getMonth()+1)).slice(-2)+"/"+s.getFullYear()},o=0!==n.length?a(null===(t=n[0])||void 0===t?void 0:t.time):a(null),u=((0,g.p)(),function(e){var t=new Date(e),n=new Date,r=-L().tz(n,i.timeZone).utcOffset();return t.setMinutes(t.getMinutes()-r),("0"+t.getDate()).slice(-2)+"/"+("0"+(t.getMonth()+1)).slice(-2)+"/"+t.getFullYear()+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)}),d=function(e){var t,n=String(s._id);try{return t=O().AES.decrypt(e,n).toString(O().enc.Utf8)}catch(r){console.log("Error: ",r)}return t},p=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,n){var r,s,a,o,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,console.log(n),e.next=5,S.Z.get(n,{responseType:"blob",headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(i.token)}});case 5:r=e.sent,s=window.URL.createObjectURL(new Blob([r.data])),(a=document.createElement("a")).style.display="none",a.href=s,o=n.split("/"),l=o.pop(),a.download=""+l,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("Error while downloading the image ",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,N.jsxs)(A.Z,{children:[(0,N.jsxs)(f.x,{fontWeight:"hairline",display:"flex",justifyContent:"center",children:[(0,N.jsx)(I.i,{}),o,(0,N.jsx)(I.i,{})]}),n&&n.map((function(e,t){return(0,N.jsxs)("div",{children:[(0,N.jsx)(f.x,{fontWeight:"hairline",display:o!=a(null===e||void 0===e?void 0:e.time)&&(r=a(null===e||void 0===e?void 0:e.time),o=r,1)?"flex":"none",justifyContent:"center",children:o}),(0,N.jsxs)("div",{style:{display:"flex"},children:[((0,w.KF)(n,e,t,i._id)||(0,w.Iq)(n,t,i._id))&&(0,N.jsx)(F.u,{label:e.sender.name,placement:"bottom-start",hasArrow:!0,children:(0,N.jsx)(z.q,{mt:"15px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})}),"text"==e.type?(0,N.jsxs)("span",{style:{backgroundColor:"".concat(e.sender._id===i._id?"#BEE3F8":"#B9F5D0"),marginLeft:(0,w.o3)(n,e,t,i._id),marginTop:(0,w.ZW)(n,e,t,i._id)?3:10,borderRadius:"13px",padding:"5px 15px",maxWidth:"75%",height:"60px"},children:[(0,N.jsx)("span",{style:{fontSize:"10px"},children:u(null===e||void 0===e?void 0:e.time)}),(0,N.jsx)("br",{}),d(null===e||void 0===e?void 0:e.content)]}):(0,N.jsxs)("div",{style:{backgroundColor:"".concat(e.sender._id===i._id?"#BEE3F8":"#B9F5D0"),marginLeft:(0,w.o3)(n,e,t,i._id),marginTop:(0,w.ZW)(n,e,t,i._id)?3:10,borderRadius:"10px",padding:"1px 10px",width:"270px",height:"auto",maxWidth:"75%",display:"flex",flexDirection:"column"},onClick:function(t){return p(t,null===e||void 0===e?void 0:e.url)},children:[(0,N.jsx)("span",{display:"block",style:{fontSize:"10px",paddingBottom:"7px",paddingTop:"5px",paddingLeft:"5px"},children:u(null===e||void 0===e?void 0:e.time)}),(0,N.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,N.jsx)("img",{src:R[e.url.split(".").pop()],style:{height:50,width:50,marginLeft:"0",display:"block",objectFit:"cover"}}),(0,N.jsx)("span",{style:{display:"block",fontSize:15,margin:"auto"},children:d(null===e||void 0===e?void 0:e.content)})]})]})]})]},e._id);var r}))]})},T=n(7780),W=JSON.parse('{"ip":0,"fr":60,"v":"5.1.20","assets":[],"layers":[{"ty":4,"nm":"Ellipse_3","ip":0,"st":0,"ind":4,"hix":1,"ks":{"o":{"a":0,"k":100},"or":{"a":0,"k":[0,0,0]},"a":{"a":0,"k":[3,3,0]},"p":{"s":true,"x":{"a":0,"k":56.943},"y":{"a":1,"k":[{"t":0,"s":[35.651],"e":[30.651],"i":{"x":[0.735],"y":[0.045]},"o":{"x":[0.6],"y":[-0.28]}},{"t":39,"s":[30.651],"e":[35.651],"i":{"x":[0.32],"y":[1.275]},"o":{"x":[0.175],"y":[0.885]}},{"t":65}]}},"rx":{"a":0,"k":0},"ry":{"a":0,"k":0},"rz":{"a":0,"k":0},"s":{"a":1,"k":[{"t":0,"s":[100,100],"e":[70,70],"i":{"x":[0.675,0.675],"y":[0.19,0.19]},"o":{"x":[0.55,0.55],"y":[0.055,0.055]}},{"t":39,"s":[70,70],"e":[100,100],"i":{"x":[0.45,0.45],"y":[0.94,0.94]},"o":{"x":[0.25,0.25],"y":[0.46,0.46]}},{"t":65}]}},"shapes":[{"ty":"gr","nm":"Ellipse_3 shape group","it":[{"ty":"el","p":{"a":0,"k":[23,3]},"s":{"a":0,"k":[6,6]}},{"ty":"st","o":{"a":0,"k":0},"w":{"a":0,"k":0},"c":{"a":0,"k":[0,0,0,0]},"lc":3,"lj":1,"ml":1},{"ty":"gf","o":{"a":0,"k":100},"r":1,"g":{"p":1,"k":{"a":0,"k":[1,0.1568627450980392,0.45098039215686275,0.9647058823529412]}},"t":1,"s":{"a":0,"k":[23,0]},"e":{"a":0,"k":[23,6]}},{"ty":"tr","o":{"a":0,"k":100},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"p":{"a":0,"k":[-20,0]},"r":{"a":0,"k":0}}]}],"op":65},{"ty":4,"nm":"Ellipse_2","ip":0,"st":0,"ind":3,"hix":2,"ks":{"o":{"a":0,"k":100},"or":{"a":0,"k":[0,0,0]},"a":{"a":0,"k":[3,3,0]},"p":{"s":true,"x":{"a":0,"k":46.943},"y":{"a":1,"k":[{"t":0,"s":[35.651],"e":[30.651],"i":{"x":[0.735],"y":[0.045]},"o":{"x":[0.6],"y":[-0.28]}},{"t":35,"s":[30.651],"e":[35.651],"i":{"x":[0.32],"y":[1.275]},"o":{"x":[0.175],"y":[0.885]}},{"t":60}]}},"rx":{"a":0,"k":0},"ry":{"a":0,"k":0},"rz":{"a":0,"k":0},"s":{"a":1,"k":[{"t":0,"s":[100,100],"e":[80,70],"i":{"x":[0.675,0.675],"y":[0.19,0.19]},"o":{"x":[0.55,0.55],"y":[0.055,0.055]}},{"t":35,"s":[80,70],"e":[100,100],"i":{"x":[0.45,0.45],"y":[0.94,0.94]},"o":{"x":[0.25,0.25],"y":[0.46,0.46]}},{"t":60}]}},"shapes":[{"ty":"gr","nm":"Ellipse_2 shape group","it":[{"ty":"el","p":{"a":0,"k":[13,3]},"s":{"a":0,"k":[6,6]}},{"ty":"st","o":{"a":0,"k":0},"w":{"a":0,"k":0},"c":{"a":0,"k":[0,0,0,0]},"lc":3,"lj":1,"ml":1},{"ty":"gf","o":{"a":0,"k":100},"r":1,"g":{"p":1,"k":{"a":0,"k":[1,0.1568627450980392,0.45098039215686275,0.9647058823529412]}},"t":1,"s":{"a":0,"k":[13,0]},"e":{"a":0,"k":[13,6]}},{"ty":"tr","o":{"a":0,"k":60},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"p":{"a":0,"k":[-10,0]},"r":{"a":0,"k":0}}]}],"op":65},{"ty":4,"nm":"Ellipse","ip":0,"st":0,"ind":2,"hix":3,"ks":{"o":{"a":0,"k":100},"or":{"a":0,"k":[0,0,0]},"a":{"a":0,"k":[3,3,0]},"p":{"s":true,"x":{"a":0,"k":36.943},"y":{"a":1,"k":[{"t":0,"s":[35.651],"e":[30.651],"i":{"x":[0.735],"y":[0.045]},"o":{"x":[0.6],"y":[-0.28]}},{"t":30,"s":[30.651],"e":[35.651],"i":{"x":[0.32],"y":[1.275]},"o":{"x":[0.175],"y":[0.885]}},{"t":55}]}},"rx":{"a":0,"k":0},"ry":{"a":0,"k":0},"rz":{"a":0,"k":0},"s":{"a":1,"k":[{"t":0,"s":[100,100],"e":[70,70],"i":{"x":[0.675,0.675],"y":[0.19,0.19]},"o":{"x":[0.55,0.55],"y":[0.055,0.055]}},{"t":30,"s":[70,70],"e":[100,100],"i":{"x":[0.45,0.45],"y":[0.94,0.94]},"o":{"x":[0.25,0.25],"y":[0.46,0.46]}},{"t":55}]}},"shapes":[{"ty":"gr","nm":"Ellipse shape group","it":[{"ty":"el","p":{"a":0,"k":[3,3]},"s":{"a":0,"k":[6,6]}},{"ty":"st","o":{"a":0,"k":0},"w":{"a":0,"k":0},"c":{"a":0,"k":[0,0,0,0]},"lc":3,"lj":1,"ml":1},{"ty":"gf","o":{"a":0,"k":100},"r":1,"g":{"p":1,"k":{"a":0,"k":[1,0.1568627450980392,0.45098039215686275,0.9647058823529412]}},"t":1,"s":{"a":0,"k":[3,0]},"e":{"a":0,"k":[3,6]}},{"ty":"tr","o":{"a":0,"k":40},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0}}]}],"op":65}],"op":65,"w":94,"h":72}'),q=n(833),Y=n(9126),P=n(840),K=n(1820),Q=n(2449),H=n(1461),J=n(9884),$=n(7573),G=function(e){var t=e.fetchMessages,n=e.fetchAgain,r=e.setFetchAgain,o=(0,m.q)(),u=o.isOpen,f=o.onOpen,x=o.onClose,h=(0,a.useState)(),v=(0,i.Z)(h,2),w=v[0],E=v[1],z=(0,a.useState)(""),F=(0,i.Z)(z,2),A=F[0],D=F[1],O=(0,a.useState)([]),I=(0,i.Z)(O,2),U=I[0],L=I[1],R=(0,a.useState)(!1),B=(0,i.Z)(R,2),T=B[0],W=B[1],q=(0,a.useState)(!1),Y=(0,i.Z)(q,2),G=Y[0],V=Y[1],X=(0,g.p)(),ee=(0,M.g)(),te=ee.selectedChat,ne=ee.setSelectedChat,re=ee.user,ie=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(i){var s,a,o;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te.groupAdmin._id===re._id||i._id===re._id){e.next=3;break}return X({title:"Only admin can remove a user!",status:"error",duration:2e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,W(!0),s={headers:{Authorization:"Bearer ".concat(re.token)}},e.next=8,S.Z.put("/api/chat/groupremove",{chatId:te._id,userId:i._id},s);case 8:a=e.sent,o=a.data,i._id===re._id?ne():ne(o),r(!n),t(),W(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),X({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:2e3,isClosable:!0,position:"bottom"}),W(!1);case 20:E("");case 21:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var n,r,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,W(!0),n={headers:{Authorization:"Bearer ".concat(re.token)}},e.next=8,S.Z.get("/api/user?search=".concat(A),n);case 8:r=e.sent,i=r.data,console.log(i),W(!1),L(i),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),X({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),W(!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,i,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,V(!0),t={headers:{Authorization:"Bearer ".concat(re.token)}},e.next=7,S.Z.put("/api/chat/rename",{chatId:te._id,chatName:w},t);case 7:i=e.sent,s=i.data,ne(s),r(!n),V(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),X({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:2e3,isClosable:!0,position:"bottom"}),V(!1);case 18:E("");case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var i,s,a;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!te.users.find((function(e){return e._id===t._id}))){e.next=3;break}return X({title:"User Already in group!",status:"error",duration:2e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(te.groupAdmin._id===re._id){e.next=6;break}return X({title:"Only admin can add a user!",status:"error",duration:2e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,W(!0),i={headers:{Authorization:"Bearer ".concat(re.token)}},e.next=11,S.Z.put("/api/chat/groupadd",{chatId:te._id,userId:t._id},i);case 11:s=e.sent,a=s.data,ne(a),r(!n),W(!1),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),X({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:2e3,isClosable:!0,position:"bottom"}),W(!1);case 22:E("");case 23:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t){return e.apply(this,arguments)}}();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(k.h,{display:{base:"flex"},icon:(0,N.jsx)(P.s,{}),onClick:f}),(0,N.jsxs)(K.u_,{onClose:x,isOpen:u,isCentered:!0,children:[(0,N.jsx)(y.Z,{}),(0,N.jsxs)(Q.h,{children:[(0,N.jsx)(j.x,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center",children:te.chatName}),(0,N.jsx)(H.o,{}),(0,N.jsxs)(b.f,{display:"flex",flexDir:"column",alignItems:"center",children:[(0,N.jsx)(s.xu,{w:"100%",display:"flex",flexWrap:"wrap",pb:3,children:te.users.map((function(e){return(0,N.jsx)(J.Z,{user1:e,admin:te.groupAdmin,handleFunction:function(){return ie(e)}},e._id)}))}),(0,N.jsxs)(d.NI,{display:"flex",children:[(0,N.jsx)(p.I,{placeholder:"Chat Name",mb:3,value:w,onChange:function(e){return E(e.target.value)}}),(0,N.jsx)(Z.z,{variant:"solid",colorScheme:"blue",ml:1,isLoading:G,onClick:ae,children:"Update"})]}),(0,N.jsx)(d.NI,{children:(0,N.jsx)(p.I,{placeholder:"Add User to group",mb:1,onChange:function(e){return se(e.target.value)}})}),T?(0,N.jsx)(C.$,{size:"lg"}):null===U||void 0===U?void 0:U.slice(0,2).map((function(e){return(0,N.jsx)($.Z,{user:e,handleFunction:function(){return oe(e)}},e._id)}))]}),(0,N.jsx)(_.m,{children:(0,N.jsx)(Z.z,{onClick:function(){return ie(re)},colorScheme:"red",children:"Leave Group"})})]})]})]})},V=n(6856),X=n(4880),ee=n(5801),te=function(e){var t=e.fetchAgain,n=e.setFetchAgain,z=(0,a.useRef)(),F=(0,a.useState)([]),A=(0,i.Z)(F,2),D=A[0],I=A[1],U=(0,a.useState)(!1),R=(0,i.Z)(U,2),P=R[0],K=R[1],Q=(0,a.useState)(!1),H=(0,i.Z)(Q,2),J=(H[0],H[1]),$=(0,a.useState)(""),te=(0,i.Z)($,2),ne=te[0],re=te[1],ie=(0,a.useState)(!1),se=(0,i.Z)(ie,2),ae=(se[0],se[1],(0,a.useState)(!1)),oe=(0,i.Z)(ae,2),ce=oe[0],le=oe[1],ue=(0,a.useState)(!1),de=(0,i.Z)(ue,2),pe=de[0],fe=de[1],xe=(0,a.useState)(!1),he=(0,i.Z)(xe,2),me=he[0],ge=he[1],ke=(0,m.q)(),ve=ke.isOpen,ye=ke.onOpen,je=ke.onClose,be=(0,a.useState)(""),_e=(0,i.Z)(be,2),Ze=_e[0],Ce=_e[1],we=(0,a.useState)(""),Se=(0,i.Z)(we,2),Ee=Se[0],ze=Se[1],Fe=(0,a.useState)({}),Ae=(0,i.Z)(Fe,2),De=(Ae[0],Ae[1],(0,a.useRef)()),Oe=(0,M.g)(),Ie=Oe.selectedChat,Me=Oe.setSelectedChat,Ue=Oe.user,Le=Oe.notification,Ne=Oe.setNotification,Re=Oe.newMsg,Be=Oe.setNewMsg,Te=Oe.activeUsers,We=Oe.socket,qe=Oe.socketConnected,Ye=(0,ee.x6)(),Pe=Ye.transcript,Ke=Ye.resetTranscript,Qe=Ye.listening,He=(0,g.p)(),Je=((0,X.k6)(),{loop:!0,autoplay:!0,animationData:W,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}});(0,a.useEffect)((function(){Pe&&(z.current.value=Pe,re(Pe))}),[Pe]);var $e=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ie){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(Ue.token)}},K(!0),e.next=7,S.Z.get("/api/message/".concat(Ie._id),t);case 7:n=e.sent,r=n.data,I(r),K(!1),We.emit("join chat",Ie._id),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),He({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var n,r,i,s,a,l,u,d;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||!ne||Ze){e.next=20;break}return We.emit("stop typing",Ie._id),e.prev=2,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Ue.token)}},re(""),r=O().AES.encrypt(ne,String(Ie._id)).toString(),e.next=8,S.Z.post("/api/message",{content:r,chatId:Ie,type:"text",url:""},n);case 8:i=e.sent,s=i.data,We.emit("new message",s),I([].concat((0,o.Z)(D),[s])),Be([].concat((0,o.Z)(Re),[s])),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),He({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 18:e.next=38;break;case 20:if("Enter"!==t.key||!ne||!Ze){e.next=38;break}return e.prev=21,a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(Ue.token)}},re(""),ze(""),l=O().AES.encrypt(ne,String(Ie._id)).toString(),e.next=28,S.Z.post("/api/message",{content:l,chatId:Ie,type:"file",url:String(Ee)},a);case 28:u=e.sent,d=u.data,We.emit("new message",d),I([].concat((0,o.Z)(D),[d])),Be([].concat((0,o.Z)(Re),[d])),e.next=38;break;case 35:e.prev=35,e.t1=e.catch(21),He({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"});case 38:case"end":return e.stop()}}),e,null,[[2,15],[21,35]])})));return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){We.on("typing",(function(){return fe(!0)})),We.on("stop typing",(function(){return fe(!1)})),We.on("show calling",(function(){J(!0)}))}),[]),(0,a.useEffect)((function(){$e(),r=Ie}),[Ie]),(0,a.useEffect)((function(){We.on("message recieved",(function(e){r&&r._id===e.chat._id?(Be([].concat((0,o.Z)(D),[e])),I([].concat((0,o.Z)(D),[e]))):Le.includes(e)||(Ne([e].concat((0,o.Z)(Le))),n(!t))}))}));var Ve=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(Ue.token),e.prev=1,t={headers:{Authorization:"Bearer ".concat(Ue.token)}},e.next=5,S.Z.put("/api/chat/deletechat",{chatId:Ie._id,userId:Ue._id},t);case 5:e.sent,window.location.reload(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),Xe=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var n,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={headers:{"Content-type":"FormData",Authorization:"Bearer ".concat(Ue.token)}},console.log("Files here",t),e.next=5,S.Z.post("api/message/uploadFile/".concat(Ie._id),t,n);case 5:return r=e.sent,e.abrupt("return",r.data);case 9:e.prev=9,e.t0=e.catch(0),console.log("Error while calling the API ",e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){var e=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ze){e.next=8;break}return(t=new FormData).append("name",Ze.name),t.append("file",Ze),e.next=6,Xe(t);case 6:n=e.sent,ze(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),console.log()}),[Ze]);(0,a.useEffect)((function(){}),[z]);return(0,N.jsx)(N.Fragment,{children:Ie?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(f.x,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",display:"flex",justifyContent:{base:"space-between"},alignItems:"center",children:[(0,N.jsxs)(x.U,{children:[(0,N.jsx)(k.h,{display:{base:"flex",md:"none"},icon:(0,N.jsx)(u.R,{}),onClick:function(){return Me("")}}),(0,N.jsx)(k.h,{display:{base:"flex"},icon:(0,N.jsx)(V.ZkW,{}),onClick:ye,ml:{md:"0px!important"}}),(0,N.jsx)(v.a,{isOpen:ve,onClose:je,isCentered:!0,children:(0,N.jsx)(y.Z,{children:(0,N.jsxs)(v._,{children:[(0,N.jsx)(j.x,{children:"Delete Chat"}),(0,N.jsx)(b.f,{children:"Are you sure want to delete chat?"}),(0,N.jsxs)(_.m,{children:[(0,N.jsx)(Z.z,{onClick:je,ml:3,children:"NO"}),(0,N.jsx)(Z.z,{onClick:Ve,colorScheme:"red",ml:3,children:"YES"})]})]})})})]}),D&&(Ie.isGroupChat?(0,N.jsxs)(N.Fragment,{children:[Ie.chatName.toUpperCase(),(0,N.jsx)("div",{style:{display:"flex",flexDirection:"row"},children:(0,N.jsx)(G,{fetchMessages:$e,fetchAgain:t,setFetchAgain:n})})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(h.K,{children:[(0,N.jsx)(s.xu,{fontSize:"25px !important",children:(0,w.j2)(Ue,Ie.users)}),(0,N.jsx)(s.xu,{display:"flex",justifyContent:"center",fontSize:"12px !important",mt:"0px !important",children:function(){var e=(0,w.Q7)(Ue,Ie.users)._id,t=null===Te||void 0===Te?void 0:Te.filter((function(t){return t._id===e}))[0];return null===t||void 0===t?void 0:t.online}()?"Online":"Offline ".concat(function(e){if(!e)return"";var t=new Date(e),n=new Date,r=-L().tz(n,Ue.timeZone).utcOffset();return t.setMinutes(t.getMinutes()-r),"Last Seen At : "+(("0"+t.getDate()).slice(-2)+"/"+("0"+(t.getMonth()+1)).slice(-2)+"/"+t.getFullYear()+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2))}(function(){var e=(0,w.Q7)(Ue,Ie.users)._id,t=null===Te||void 0===Te?void 0:Te.filter((function(t){return t._id===e}))[0];return null===t||void 0===t?void 0:t.lasttime}()))})]}),(0,N.jsx)(E.Z,{user:(0,w.Q7)(Ue,Ie.users)})]}))]}),(0,N.jsxs)(s.xu,{display:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[P?(0,N.jsx)(C.$,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):(0,N.jsx)("div",{className:"messages",children:(0,N.jsx)(B,{messages:D})}),(0,N.jsxs)(d.NI,{onKeyDown:Ge,id:"first-name",isRequired:!0,mt:3,children:[pe?(0,N.jsx)("div",{children:(0,N.jsx)(T.Z,{options:Je,height:25,width:70,style:{marginBottom:15,marginLeft:0}})}):(0,N.jsx)(N.Fragment,{}),(0,N.jsxs)(x.U,{children:[(0,N.jsxs)("div",{className:"wrapper",children:[(0,N.jsx)(k.h,{className:"emoji",icon:(0,N.jsx)(Y.IZ1,{}),size:"md",backgroundColor:"#e8e8e8",variant:"solid",color:"#3182ce",onClick:function(){ge(!me)}}),me&&(0,N.jsx)("div",{className:"picker-wrapper",children:(0,N.jsx)(q.ZP,{onEmojiClick:function(e){var t=ne;t+=e.emoji,re(t)}})})]}),(0,N.jsx)(p.I,{ref:z,variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message...",onClick:function(){Ke()},onChange:function(e){if(re(e.target.value),qe){ce||(le(!0),We.emit("typing",Ie._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=3e3&&ce&&(We.emit("stop typing",Ie._id),le(!1))}),3e3)}},value:ne||Pe}),(0,N.jsx)(k.h,{icon:(0,N.jsx)(V.Lcd,{}),colorScheme:"blue",variant:"solid",onClick:function(e){e.preventDefault(),ee.ZP.browserSupportsSpeechRecognition()&&(Qe?ee.ZP.stopListening():ee.ZP.startListening({continuous:!0}))}}),(0,N.jsx)(k.h,{icon:(0,N.jsx)(V._b$,{}),colorScheme:"blue",onClick:function(){return De.current.click()},variant:"solid"}),(0,N.jsx)("input",{type:"file",ref:De,style:{display:"none"},onChange:function(e){var t;console.log(e.target.files[0]),Ce(e.target.files[0]),re(null===(t=e.target.files[0])||void 0===t?void 0:t.name)}})]})]})]})]}):(0,N.jsx)(s.xu,{display:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:(0,N.jsx)(f.x,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on a user to start chatting"})})})},ne=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=(0,M.g)().selectedChat;return(0,N.jsx)(s.xu,{display:{base:r?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"71.7%"},borderWidth:"1px",children:(0,N.jsx)(te,{fetchAgain:t,setFetchAgain:n})})},re=a.lazy((function(){return Promise.all([n.e(215),n.e(462)]).then(n.bind(n,462))})),ie=function(){var e=(0,X.k6)(),t=(0,M.g)(),n=t.user,r=t.setUser,o=(t.activeUsers,t.setActiveUsers),c=t.socket,l=t.setNotification,u=(0,a.useState)(!1),d=(0,i.Z)(u,2),p=d[0],f=d[1];return(0,a.useEffect)((function(){var t=JSON.parse(localStorage.getItem("userInfo"));l(t.notification),console.log(t.notification),t.notification=[],localStorage.setItem("userInfo",JSON.stringify(t)),r(t),c.emit("addUsers",t),t||e.push("/")}),[e]),window.addEventListener("beforeunload",(function(){c.emit("disconnect")})),(0,a.useEffect)((function(){c.on("getUsers",(function(e){o(e)}))}),[]),(0,N.jsx)("div",{style:{width:"100%"},children:(0,N.jsxs)(s.xu,{display:"flex",justifyContent:"space-between",w:"100%",h:"100vh",pl:"3px",children:[n&&(0,N.jsx)(re,{fetchAgain:p}),n&&(0,N.jsx)(ne,{fetchAgain:p,setFetchAgain:f})]})})}},1622:function(e,t,n){"use strict";n.d(t,{Iq:function(){return a},KF:function(){return s},Q7:function(){return i},ZW:function(){return c},j2:function(){return r},o3:function(){return o}});var r=function(e,t){var n,r,i;return(null===(n=t[0])||void 0===n?void 0:n._id)===(null===e||void 0===e?void 0:e._id)?null===(r=t[1])||void 0===r?void 0:r.name:null===(i=t[0])||void 0===i?void 0:i.name},i=function(e,t){return t[0]._id===e._id?t[1]:t[0]},s=function(e,t,n,r){return n<e.length-1&&(e[n+1].sender._id!==t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id!==r},a=function(e,t,n){return t===e.length-1&&e[e.length-1].sender._id!==n&&e[e.length-1].sender._id},o=function(e,t,n,r){return n<e.length-1&&e[n+1].sender._id===t.sender._id&&e[n].sender._id!==r?33:n<e.length-1&&e[n+1].sender._id!==t.sender._id&&e[n].sender._id!==r||n===e.length-1&&e[n].sender._id!==r?0:"auto"},c=function(e,t,n){return n>0&&e[n-1].sender._id===t.sender._id}},5089:function(){},2480:function(){}}]);
//# sourceMappingURL=293.69df198b.chunk.js.map